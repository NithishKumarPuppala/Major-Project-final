{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Analysis Result</h3>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-primary" href="{{ url_for('index') }}">Analyze Another Resume</a>
    <a class="btn btn-outline-secondary" href="{{ url_for('download_report', report_name=report_name) }}">
      Download Report
    </a>
  </div>
</div>

<div class="row g-4">
  <div class="col-lg-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title">{{ role.title }}</h5>
        <p class="text-muted">{{ role.description }}</p>
        <div class="score-box">
          <h2>{{ resume_score }}%</h2>
          <span>Overall Resume Score</span>
        </div>
        <div class="mt-3">
          <p class="mb-1">Skill Match: <strong>{{ skill_score }}%</strong></p>
          <p class="mb-0">JD Similarity: <strong>{{ similarity_score }}%</strong></p>
        </div>
      </div>
    </div>
    <div class="card mt-4">
      <div class="card-body">
        <h6>Career Guidance</h6>
        <p>{{ career_message }}</p>
        <h6 class="mt-3">Recommended Certifications</h6>
        {% if role.certifications %}
        <ul>
          {% for cert in role.certifications %}
          <li>{{ cert }}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-muted">Not available.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-lg-8">
    <div class="card mb-4">
      <div class="card-body">
        <h5>Skill Gap Analysis</h5>
        <div class="row">
          <div class="col-md-6">
            <h6>Matched Skills</h6>
            {% if matched_skills %}
            <ul>
              {% for skill in matched_skills %}
              <li>{{ skill }}</li>
              {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">No matched skills found.</p>
            {% endif %}
          </div>
          <div class="col-md-6">
            <h6>Missing Skills</h6>
            {% if missing_skills %}
            <ul>
              {% for skill in missing_skills %}
              <li>{{ skill }}</li>
              {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">No missing skills detected.</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-body">
        <h5>Resume Highlights</h5>
        <div class="row">
          <div class="col-md-6">
            <h6>Education</h6>
            {% if summary.education %}
            <ul>
              {% for item in summary.education %}
              <li>{{ item }}</li>
              {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">Not detected.</p>
            {% endif %}
          </div>
          <div class="col-md-6">
            <h6>Experience</h6>
            {% if summary.experience %}
            <ul>
              {% for item in summary.experience %}
              <li>{{ item }}</li>
              {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">Not detected.</p>
            {% endif %}
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <h6>Projects</h6>
            {% if summary.projects %}
            <ul>
              {% for item in summary.projects %}
              <li>{{ item }}</li>
              {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">Not detected.</p>
            {% endif %}
          </div>
          <div class="col-md-6">
            <h6>Recognized Orgs</h6>
            {% if summary.orgs %}
            <p>{{ summary.orgs | join(', ') }}</p>
            {% else %}
            <p class="text-muted">Not detected.</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h5>Recommended Courses</h5>
        {% if course_recos %}
        <div class="list-group">
          {% for course in course_recos %}
          <div class="list-group-item">
            <h6 class="mb-1">{{ course.course_title }}</h6>
            <p class="mb-1">
              Provider: {{ course.provider }} | Skill: {{ course.skill }} | Level: {{ course.level }}
            </p>
            <small>{{ course.url }}</small>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">No recommendations available.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

